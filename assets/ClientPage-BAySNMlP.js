import{c as $,B as A,C as E,h as V,a as g,t as P,r as S,D as K,w as M,u as x,v as a,x as v,E as e,F as u,z as r,G as z,H as Q,I as R,J as o,K as n,Q as p,L as w,A as c,M as F,N as q,O as G,T as J}from"./index-CxLXl_oA.js";import{u as Y,Q as W,d as X,a as B,b as Z}from"./date-BEHU2HYk.js";import{_ as tt,Q as et}from"./_plugin-vue_export-helper-Bt3W_fx9.js";import{Q as k}from"./QChip-Cwo9FD5a.js";import"./scroll-BtoeZSBr.js";const st='<path d="M30.262 57.02L7.195 40.723c-5.84-3.976-7.56-12.06-3.842-18.063 3.715-6 11.467-7.65 17.306-3.68l4.52 3.76 2.6-5.274c3.716-6.002 11.47-7.65 17.304-3.68 5.84 3.97 7.56 12.054 3.842 18.062L34.49 56.118c-.897 1.512-2.793 1.915-4.228.9z" fill-opacity=".5"><animate attributeName="fill-opacity" begin="0s" dur="1.4s" values="0.5;1;0.5" calcMode="linear" repeatCount="indefinite"></animate></path><path d="M105.512 56.12l-14.44-24.272c-3.716-6.008-1.996-14.093 3.843-18.062 5.835-3.97 13.588-2.322 17.306 3.68l2.6 5.274 4.52-3.76c5.84-3.97 13.593-2.32 17.308 3.68 3.718 6.003 1.998 14.088-3.842 18.064L109.74 57.02c-1.434 1.014-3.33.61-4.228-.9z" fill-opacity=".5"><animate attributeName="fill-opacity" begin="0.7s" dur="1.4s" values="0.5;1;0.5" calcMode="linear" repeatCount="indefinite"></animate></path><path d="M67.408 57.834l-23.01-24.98c-5.864-6.15-5.864-16.108 0-22.248 5.86-6.14 15.37-6.14 21.234 0L70 16.168l4.368-5.562c5.863-6.14 15.375-6.14 21.235 0 5.863 6.14 5.863 16.098 0 22.247l-23.007 24.98c-1.43 1.556-3.757 1.556-5.188 0z"></path>',lt=$({name:"QSpinnerHearts",props:A,setup(i){const{cSize:s,classes:b}=E(i);return()=>V("svg",{class:b.value,fill:"currentColor",width:s.value,height:s.value,viewBox:"0 0 140 64",xmlns:"http://www.w3.org/2000/svg",innerHTML:st})}}),it=["top","middle","bottom"],T=$({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:i=>it.includes(i)}},setup(i,{slots:s}){const b=g(()=>i.align!==void 0?{verticalAlign:i.align}:null),y=g(()=>{const m=i.outline===!0&&i.color||i.textColor;return`q-badge flex inline items-center no-wrap q-badge--${i.multiLine===!0?"multi":"single"}-line`+(i.outline===!0?" q-badge--outline":i.color!==void 0?` bg-${i.color}`:"")+(m!==void 0?` text-${m}`:"")+(i.floating===!0?" q-badge--floating":"")+(i.rounded===!0?" q-badge--rounded":"")+(i.transparent===!0?" q-badge--transparent":"")});return()=>V("div",{class:y.value,style:b.value,role:"status","aria-label":i.label},P(s.default,i.label!==void 0?[i.label]:[]))}}),at={key:0,class:"absolute-center text-center"},ot={key:1,class:"column flex-center q-pa-lg text-center",style:{height:"calc(100vh - 82px)"}},nt={class:"text-subtitle1 text-grey-7 q-mb-xl"},rt={class:"text-subtitle1 q-mt-sm"},dt={class:"text-primary text-weight-bolder"},ut={key:2,class:"column flex-center window-height q-pa-lg text-center"},mt={class:"text-subtitle1 text-grey-6 q-my-md"},ct={class:"text-orange text-weight-bold"},vt={class:"text-primary text-weight-bold"},bt={key:3,class:"column q-gutter-y-md"},xt={class:"cute-card relative-position overflow-hidden ticket-container animate-float"},gt={class:"q-pa-lg text-center relative-position"},yt={class:"my-number-text q-my-sm"},pt={class:"cute-card q-pa-md row items-center"},ht={class:"q-pa-md bg-orange-1 text-center"},wt={class:"text-h3 text-weight-bolder text-dark"},ft={class:"q-mt-md"},_t={class:"q-pb-xl",style:{"padding-bottom":"100px"}},qt={class:"row items-center q-mb-md"},kt={key:0,class:"banner-locked q-pa-md q-mb-md text-center text-grey-7 rounded-borders"},Ct={class:"column q-gutter-y-sm"},Nt={class:"col q-pl-sm"},St={class:"text-subtitle1 text-weight-bold text-dark"},Mt={class:"row items-center q-gutter-x-sm"},zt={class:"text-subtitle1 text-primary text-weight-bolder"},Qt={key:1,class:"text-caption text-grey-6"},Bt={key:0,class:"row items-center bg-grey-1 rounded-borders q-pa-xs"},Tt={class:"text-h6 q-mx-sm text-weight-bold",style:{"min-width":"24px","text-align":"center"}},$t={key:1,class:"q-pa-md"},Vt={key:0,class:"fixed-bottom q-pa-md glass-footer z-top"},Lt={class:"row items-center justify-between"},Dt={class:"column"},jt={class:"text-h5 text-weight-bolder text-primary"},Ht={class:"fullscreen bg-gradient-gold column flex-center text-center q-pa-md"},It={class:"text-h2 text-weight-bold q-my-lg"},Ot={class:"text-subtitle1 text-grey-8 q-mb-lg"},Ut={class:"text-primary text-weight-bold"},At={__name:"ClientPage",setup(i){const s=Y(),b=S(!1);K(()=>{s.init()});const y=g(()=>s.myNumber&&s.currentNumber>s.myNumber),m=g(()=>s.myNumber!=null&&s.currentNumber!=null?Math.max(0,s.myNumber-s.currentNumber):999),L=g(()=>!y.value&&m.value<=5&&m.value>=0),f=d=>d.soldOut||d.qty<=0,_=g(()=>!y.value&&m.value>=0),h=S("");M(()=>s.myName,d=>{d&&(h.value=d)},{immediate:!0});function C(){h.value!==s.myName&&s.updateMyName(h.value)}function D(){navigator.vibrate&&navigator.vibrate(50),s.drawNewNumber()}function j(){s.clearMyState(),setTimeout(()=>{s.drawNewNumber()},300)}function N(d,t){navigator.vibrate&&navigator.vibrate(20),s.updateCart(d,t)}function H(){navigator.vibrate&&navigator.vibrate(50),s.submitSelection()}M(L,d=>{d&&(b.value=!0)});const I=g(()=>{if(!s.startTime)return!0;const d=Date.now(),t=new Date(s.startTime).getTime();return d>=t}),O=g(()=>s.startTime?X.formatDate(s.startTime,"MM/DD HH:mm"):"");return(d,t)=>(a(),x(W,{class:"q-pa-md pb-safe relative-position"},{default:v(()=>[t[25]||(t[25]=e("div",{class:"bg-decor"},null,-1)),(a(),u(z,null,Q(20,l=>e("div",{key:l,class:"petal",style:R(`left: ${Math.random()*100}vw; width: ${10+Math.random()*15}px; height: ${10+Math.random()*15}px; animation-duration: ${8+Math.random()*10}s; animation-delay: -${Math.random()*10}s`)},null,4)),64)),o(s).isConnected?o(s).myNumber?y.value?(a(),u("div",ut,[r(w,{name:"sentiment_very_dissatisfied",size:"100px",color:"grey-5",class:"q-mb-md"}),t[12]||(t[12]=e("div",{class:"text-h4 text-grey-8 text-weight-bold"},"哎呀！您的號碼已過",-1)),e("div",mt,[t[8]||(t[8]=c(" 您的號碼是 ",-1)),e("span",ct,n(o(s).myNumber),1),t[9]||(t[9]=e("br",null,null,-1)),t[10]||(t[10]=c(" 目前已經服務到 ",-1)),e("span",vt,n(o(s).currentNumber),1),t[11]||(t[11]=c(" 號 ",-1))]),r(p,{push:"",rounded:"",size:"lg",color:"secondary","text-color":"primary",class:"jelly-btn shadow-3",label:"重新抽取號碼牌",icon:"refresh",onClick:j})])):(a(),u("div",bt,[t[20]||(t[20]=e("div",{class:"text-center q-mt-sm"},[e("div",{class:"text-h5 text-weight-bolder text-primary"},"✨ 排隊選購 ✨"),e("div",null,"ヽ(∀ﾟ )人(ﾟ∀ﾟ)人( ﾟ∀)人(∀ﾟ )人(ﾟ∀ﾟ)人( ﾟ∀)ﾉ")],-1)),e("div",xt,[t[17]||(t[17]=e("div",{class:"absolute-top full-width bg-gradient-gold",style:{height:"8px"}},null,-1)),e("div",gt,[t[13]||(t[13]=e("div",{class:"text-subtitle2 text-grey-6 text-weight-bold"},"YOUR NUMBER",-1)),e("div",yt,n(o(s).myNumber),1)]),t[18]||(t[18]=e("div",{class:"row justify-between items-center no-wrap q-px-sm"},[e("div",{class:"circle-cutout"}),e("div",{class:"dashed-line col"}),e("div",{class:"circle-cutout right"})],-1)),e("div",pt,[t[14]||(t[14]=e("div",{class:"text-subtitle1 text-weight-bold text-dark q-mr-md"},"您的暱稱:",-1)),r(et,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=l=>h.value=l),dense:"",borderless:"",class:"col cookie-box text-h6 text-primary text-center",placeholder:"請輸入稱呼",onBlur:C,onKeyup:F(C,["enter"])},null,8,["modelValue"])]),e("div",ht,[t[16]||(t[16]=e("div",{class:"text-subtitle1 text-grey-7"},"目前服務號碼 Current Call",-1)),e("div",wt,"No."+n(o(s).currentNumber),1),e("div",ft,[m.value>5?(a(),x(k,{key:0,color:"grey-4","text-color":"grey-8",icon:"coffee"},{default:v(()=>[c(" 前方還有 "+n(m.value)+" 組顧客 ",1)]),_:1})):m.value>0?(a(),x(k,{key:1,color:"primary","text-color":"white",icon:"hourglass_top"},{default:v(()=>[c(" 即將輪到您！剩 "+n(m.value)+" 組 ",1)]),_:1})):(a(),x(k,{key:2,color:"negative","text-color":"white",icon:"stars"},{default:v(()=>[...t[15]||(t[15]=[c(" 輪到您了！請前往攤位 ",-1)])]),_:1}))])])]),e("div",_t,[e("div",qt,[r(w,{name:"shopping_cart",color:"accent",size:"sm"}),t[19]||(t[19]=e("div",{class:"text-h6 q-ml-sm text-weight-bold text-dark"},"預選您想購買的商品 (可複選)",-1))]),_.value?q("",!0):(a(),u("div",kt,[r(w,{name:"lock"}),c(" 還有 "+n(m.value)+" 號以上，暫時無法進行預選 ",1)])),e("div",Ct,[(a(!0),u(z,null,Q(o(s).products,l=>(a(),u("div",{key:l.id,class:G(["cute-card q-pa-sm row items-center no-wrap",{"opacity-60":f(l)}])},[e("div",Nt,[e("div",St,n(l.name),1),e("div",Mt,[e("div",zt," $"+n(l.price),1),f(l)?(a(),x(T,{key:0,color:"grey-8",label:"已售完",class:"text-weight-bold"})):(a(),u("div",Qt,"庫存 "+n(l.qty),1)),l.limit>0?(a(),x(T,{key:2,outline:"",color:"pink-4",class:"bg-pink-1 text-weight-bold"},{default:v(()=>[c("限購 "+n(l.limit),1)]),_:2},1024)):q("",!0)])]),_.value&&!f(l)?(a(),u("div",Bt,[r(p,{round:"",dense:"",flat:"",icon:"remove",color:"grey-7",onClick:U=>N(l.id,-1),disable:!o(s).myCart[l.id]},null,8,["onClick","disable"]),e("div",Tt,n(o(s).myCart[l.id]||0),1),r(p,{round:"",dense:"",flat:"",icon:"add",color:"primary",onClick:U=>N(l.id,1),disable:l.qty<=(o(s).myCart[l.id]||0)||l.limit>0&&(o(s).myCart[l.id]||0)>=l.limit},null,8,["onClick","disable"])])):(a(),u("div",$t,[r(w,{name:"lock",color:"grey-4",size:"sm"})]))],2))),128))])])])):(a(),u("div",ot,[t[7]||(t[7]=e("div",{class:"text-h4 text-weight-bolder text-primary q-mb-md"},"歡迎光臨排隊選購 ✨",-1)),e("div",nt,"目前排隊人數 "+n(o(s).queueCount)+" 人",1),I.value?(a(),x(p,{key:0,push:"",rounded:"",size:"xl",color:"primary",class:"jelly-btn shadow-5",label:"抽取排隊號碼牌",icon:"confirmation_number",onClick:D})):(a(),x(B,{key:1,class:"cute-card q-pa-lg bg-grey-2 text-grey-8"},{default:v(()=>[r(w,{name:"schedule",size:"3rem",color:"grey-6",class:"q-mb-sm"}),t[6]||(t[6]=e("div",{class:"text-h6 text-weight-bold"},"活動尚未開始",-1)),e("div",rt,[t[4]||(t[4]=c(" 開放抽票時間：",-1)),t[5]||(t[5]=e("br",null,null,-1)),e("span",dt,n(O.value),1)])]),_:1}))])):(a(),u("div",at,[r(lt,{color:"primary",size:"4em"}),t[3]||(t[3]=e("div",{class:"text-primary q-mt-md"},"連線中...",-1))])),r(J,{name:"slide-up"},{default:v(()=>[o(s).myNumber&&!y.value&&_.value?(a(),u("div",Vt,[e("div",Lt,[e("div",Dt,[t[21]||(t[21]=e("div",{class:"text-caption text-grey-7"},"預估總金額 Total",-1)),e("div",jt,"$"+n(o(s).cartTotal),1)]),r(p,{push:"",rounded:"",color:"positive",class:"jelly-btn q-px-xl shadow-3",label:o(s).isSubmitted?"更新預選清單":"確認送出預選",icon:o(s).isSubmitted?"update":"check_circle",disable:o(s).cartCount==0,onClick:H},null,8,["label","icon","disable"])])])):q("",!0)]),_:1}),r(Z,{modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=l=>b.value=l),persistent:"",maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:v(()=>[e("div",Ht,[r(B,{class:"cute-card q-pa-xl shadow-24"},{default:v(()=>[t[24]||(t[24]=e("div",{class:"text-h4 text-weight-bolder text-primary"},"輪到您了！",-1)),e("div",It,"No."+n(o(s).myNumber),1),e("div",Ot,[t[22]||(t[22]=c(" 請帶著您的手機前往攤位排隊!",-1)),t[23]||(t[23]=e("br",null,null,-1)),e("span",Ut,"預選金額: $"+n(o(s).cartTotal),1)]),r(p,{label:"我現在前往攤位",color:"primary",rounded:"",size:"lg",onClick:t[1]||(t[1]=l=>b.value=!1),class:"jelly-btn"})]),_:1})])]),_:1},8,["modelValue"])]),_:1}))}},Gt=tt(At,[["__scopeId","data-v-7faad40b"]]);export{Gt as default};
